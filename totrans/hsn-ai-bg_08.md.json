["```py\npip install gym\n```", "```py\nimport gym\nimport numpy as np\n\ndef gen_random_policy():\n return (np.random.uniform(-1,1, size=4), np.random.uniform(-1,1))\n```", "```py\ndef policy_to_action(env, policy, obs):\n if np.dot(policy[0], obs) + policy[1] > 0:\n return 1\n else:\n return 0\n```", "```py\ndef run_episode(env, policy, t_max=1000, render=False):\n obs = env.reset()\n total_reward = 0\n for i in range(t_max):\n if render:\n env.render()\n selected_action = policy_to_action(env, policy, obs)\n obs, reward, done, _ = env.step(selected_action)\n total_reward += reward\n if done:\n break\n return total_reward\n\nif __name__ == '__main__':\n env = gym.make('CartPole-v0')\n\n n_policy = 500\n policy_list = [gen_random_policy() for _ in range(n_policy)]\n\n scores_list = [run_episode(env, p) for p in policy_list]\n\n print('Best policy score = %f' %max(scores_list))\n\n best_policy= policy_list[np.argmax(scores_list)]\n print('Running with best policy:\\n')\n run_episode(env, best_policy, render=True)\n```"]