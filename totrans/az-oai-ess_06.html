<html><head></head><body>
		<div id="_idContainer114">
			<h1 id="_idParaDest-78" class="chapter-number"><a id="_idTextAnchor077"/>6</h1>
			<h1 id="_idParaDest-79"><a id="_idTextAnchor078"/>Querying From a Structured Database</h1>
			<p>In the last chapter, we learned about using ChatGPT to analyze customer conversations and get useful information. Now, let’s imagine we’ve stored all this valuable info in a SQL database. As you can imagine, this database is like a treasure chest filled with different and <span class="No-Break">important details.</span></p>
			<p>Meet Sarah, our awesome customer care manager. Her job is to uncover the stories hidden in this sea of data. In the past, finding these stories meant being a master of SQL queries, a kind of language not everyone understands. Crafting these queries was like solving a puzzle and took a lot of time even for <span class="No-Break">experienced users.</span></p>
			<p>But now, a new chapter begins—the birth of SQL GPT. No longer stuck with tricky SQL rules, Sarah now has a tool that understands simple language. Instead of writing complex queries, she talks to the database like she’s chatting with <span class="No-Break">a friend.</span></p>
			<p>Using SQL GPT, Sarah explores the database’s analytics using easy English prompts. Curious about last month’s satisfaction score or the number of audio conversations? <span class="No-Break">Just ask!</span></p>
			<p> In this chapter, we embark on a mission to simplify data for everyone. SQL GPT serves as a friendly bridge between the complex world of databases and users of all skill levels, transforming everyday questions into powerful SQL queries. Together, we’ll explore how this tool makes data accessible and empowers people, like Sarah, to uncover meaningful insights with ease. While SQL GPT is a great resource for beginners learning SQL, it also proves invaluable for experienced users, helping them craft even the most complex queries effortlessly. Let’s dive into this exciting journey to unlock the true potential <span class="No-Break">of data!</span></p>
			<p>This chapter covers the <span class="No-Break">following topics:</span></p>
			<ul>
				<li><span class="No-Break">Architecture design</span></li>
				<li>Developing an SQL <span class="No-Break">GPT section</span></li>
			</ul>
			<h1 id="_idParaDest-80"><a id="_idTextAnchor079"/>Technical requirements</h1>
			<p>To follow along with the practical exercises in this chapter, access the source code available in this chapter's GitHub repository <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Azure-OpenAI-Essentials/blob/main/Chapter6.ipynb"><span class="No-Break">https://github.com/PacktPublishing/Azure-OpenAI-Essentials/blob/main/Chapter6.ipynb</span></a><span class="No-Break">.</span></p>
			<p>Following are the requirements that are already configured in <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a><span class="No-Break">:</span></p>
			<ul>
				<li>Python 3.9, 3.10, or 3.11 - <a href="https://www.python.org/downloads/"><span class="No-Break">https://www.python.org/downloads/</span></a></li>
				<li>Azure Developer CLI - Azure developer <span class="No-Break">CLI Installation</span></li>
				<li>Node.js 14+ - <a href="https://nodejs.org/en/download"><span class="No-Break">https://nodejs.org/en/download</span></a></li>
				<li>Git - <a href="https://git-scm.com/downloads"><span class="No-Break">https://git-scm.com/downloads</span></a></li>
				<li>Powershell 7+ (<strong class="source-inline">pwsh</strong>) - <a href="https://github.com/powershell/powershell"><span class="No-Break">https://github.com/powershell/powershell</span></a></li>
				<li>Azure account - If you’re new to Azure, get an Azure account for free and you’ll get some free Azure credits to <span class="No-Break">get started.</span></li>
				<li>Azure subscription with access enabled for the Azure OpenAI service. You can request access with <span class="No-Break">this form.</span></li>
				<li>Azure OpenAI connection and <span class="No-Break">model information:</span><ul><li>OpenAI <span class="No-Break">API key</span></li><li>OpenAI embedding model <span class="No-Break">deployment name</span></li><li>OpenAI <span class="No-Break">API version</span></li></ul></li>
				<li>An SQL Server with database <span class="No-Break">connection strings</span></li>
			</ul>
			<p>As we can see, we only need an SQL Server with database connection strings in addition to the requirements specific in <a href="B21019_05.xhtml#_idTextAnchor067"><span class="No-Break"><em class="italic">Chapter 5</em></span></a> and <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-81"><a id="_idTextAnchor080"/>Architecture design</h1>
			<p>The process behind developing our GPT solution<a id="_idIndexMarker333"/> begins when the user sends a text-based query. Azure OpenAI then processes this query, converting it into a SQL command, which is passed to the SQL server. The SQL server executes the command and returns the results, which are then sent back to the user. This is represented in the <span class="No-Break">following image:</span></p>
			<div>
				<div id="_idContainer102" class="IMG---Figure">
					<img src="image/B21019_06_1.jpg" alt="Figure 6.1: Solution architecture diagram"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.1: Solution architecture diagram</p>
			<p>In the<a id="_idIndexMarker334"/> preceding architecture diagram, we see three key components: the User, Azure OpenAI, and a SQL server. The arrows illustrate the flow of data between <span class="No-Break">these components.</span></p>
			<h1 id="_idParaDest-82"><a id="_idTextAnchor081"/>Developing an SQLGPT solution</h1>
			<p>Now that we’re familiar<a id="_idIndexMarker335"/> with the architectural elements necessary for creating this solution, let’s proceed with the implementation of these components in the Azure portal. As mentioned in <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, it’s crucial to have an active Azure account for this section. Details for setting up the Azure account with an active subscription and the Azure OpenAI Service resource are provided in <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a><span class="No-Break">.</span></p>
			<p>Let’s look into the steps for creating an SQL sever <span class="No-Break">in Azure:</span></p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor082"/>Creating an SQL Server in Azure</h2>
			<p>To <a id="_idIndexMarker336"/>create an <a id="_idIndexMarker337"/>SQL Server, we will use<a id="_idIndexMarker338"/> the <span class="No-Break">following steps:</span></p>
			<ol>
				<li><span class="No-Break">Open </span><a href="http://portal.azure.com"><span class="No-Break">portal.azure.com</span></a></li>
				<li>Navigate to the search bar in the top navigation and search for “<span class="No-Break"><strong class="source-inline">SQL Database</strong></span><span class="No-Break">”.</span></li>
				<li>If it is not found in the search results, click on <strong class="bold">Create Resource</strong> and in the marketplace search for “<span class="No-Break"><strong class="source-inline">SQL Database</strong></span><span class="No-Break">”</span></li>
			</ol>
			<div>
				<div id="_idContainer103" class="IMG---Figure">
					<img src="image/B21019_06_2.jpg" alt="Figure 6.2: Select SQL Database"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.2: Select SQL Database</p>
			<ol>
				<li value="4">Click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Create</strong></span></li>
				<li>Select the <strong class="bold">Subscription</strong> and <strong class="bold">Resource</strong> group in the <strong class="bold">Create Resource Form</strong> (Eg: <span class="No-Break"><strong class="source-inline">azure-openai-rg</strong></span><span class="No-Break">) .</span></li>
			</ol>
			<div>
				<div id="_idContainer104" class="IMG---Figure">
					<img src="image/B21019_06_3.jpg" alt="Figure 6.3: Enter Database details"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.3: Enter Database details</p>
			<ol>
				<li value="6">Now give your desired <a id="_idIndexMarker339"/>database name <a id="_idIndexMarker340"/>and server <a id="_idIndexMarker341"/><span class="No-Break">for database.</span></li>
				<li>For Server, select Create new, and fill out the New server form with the following values - <strong class="bold">Server name</strong>, <strong class="bold">Location</strong>, <strong class="bold">Authentication method</strong>, <strong class="bold">Server admin login</strong>, <strong class="bold">Password</strong>, and click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Ok</strong></span><span class="No-Break">.</span></li>
			</ol>
			<div>
				<div id="_idContainer105" class="IMG---Figure">
					<img src="image/B21019_06_4.jpg" alt="Figure 6.4: Enter SQL Server details"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.4: Enter SQL Server details</p>
			<p class="list-inset">Once the Server is<a id="_idIndexMarker342"/> created then we need<a id="_idIndexMarker343"/> to select the <a id="_idIndexMarker344"/>server for creating the <span class="No-Break">SQL database.</span></p>
			<ol>
				<li value="8">Select the Workload environment, Compute+storage and click on <strong class="bold">Next</strong>. For <strong class="bold">Networking</strong> tab, toggle <strong class="bold">Add current client IP address</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="bold">Yes</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer106" class="IMG---Figure">
					<img src="image/B21019_06_5.jpg" alt="Figure 6.5: Enter SQL database details"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.5: Enter SQL database details</p>
			<ol>
				<li value="9">Click on <strong class="bold">Next</strong> in<a id="_idIndexMarker345"/> the <strong class="bold">Networking</strong> page <a id="_idIndexMarker346"/>and leave the <strong class="bold">Security</strong>, <strong class="bold">Additional</strong> <strong class="bold">Settings</strong> <strong class="bold">Tags</strong> as defaults <a id="_idIndexMarker347"/>and go to <strong class="bold">Review + </strong><span class="No-Break"><strong class="bold">create</strong></span><span class="No-Break"> page:</span></li>
			</ol>
			<div>
				<div id="_idContainer107" class="IMG---Figure">
					<img src="image/B21019_06_6.jpg" alt="Figure 6.6: Review Page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.6: Review Page</p>
			<ol>
				<li value="10">Review <a id="_idIndexMarker348"/>all the details and click on the <strong class="bold">Create</strong> button to <a id="_idIndexMarker349"/>create the SQL Server <span class="No-Break">and</span><span class="No-Break"><a id="_idIndexMarker350"/></span><span class="No-Break"> database.</span></li>
			</ol>
			<p>Now that we have set up all the essential services in our Azure portal, we can begin constructing <span class="No-Break">our solution.</span></p>
			<h2 id="_idParaDest-84"><a id="_idTextAnchor083"/>Solution using Azure SQL and ChatGPT</h2>
			<p>To develop the <a id="_idIndexMarker351"/>code, I will be working within the Jupyter notebook and the remaining installations remain the same as in <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>. You will find all the necessary items, including the Python notebook, in the chapter 6 folder of this book’s GitHub repository at - <a href="https://github.com/PacktPublishing/Azure-OpenAI-Essentials/blob/main/Chapter6.ipynb"><span class="No-Break">https://github.com/PacktPublishing/Azure-OpenAI-Essentials/blob/main/Chapter6.ipynb</span></a></p>
			<p>You will need to install one extra Python library for this code other than the one installed in <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a><span class="No-Break">.</span></p>
			<p>Create a new Jupyter Notebook and install the <span class="No-Break">following package:</span></p>
			<pre class="console">
pip install pyspark</pre>			<p>Our code includes the following sections in which we are going to develop <span class="No-Break">our solution</span></p>
			<ol>
				<li><span class="No-Break">Importing packages</span></li>
				<li>Setting DB <span class="No-Break">connection strings</span></li>
				<li>Sample <span class="No-Break">Query testing</span></li>
				<li>Use the ChatGPT <span class="No-Break">deployed model</span></li>
				<li>Create a<a id="_idIndexMarker352"/> Pandas agent and <span class="No-Break">ask questions</span></li>
			</ol>
			<h2 id="_idParaDest-85"><a id="_idTextAnchor084"/>Importing Packages</h2>
			<p>We need to <a id="_idIndexMarker353"/>import the required packages before we develop <span class="No-Break">the solution.</span></p>
			<pre class="source-code">
import pyodbc
import pandas as pd
from langchain.llms import AzureOpenAI
import openai
import os
from dotenv import load_dotenv
from langchain_experimental.agents.agent_toolkits import (
    create_spark_dataframe_agentimport openai)</pre>			<p>You can see a variety of libraries being used in the code above. Let’s delve into each of these libraries in the <span class="No-Break">table here:</span></p>
			<table id="table001-4" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p><span class="No-Break"><strong class="bold">Imported Packages</strong></span></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">pyodbc</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>A Python module for ODBC (Open Database Connectivity) <span class="No-Break">database access.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">pandas</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>A powerful data manipulation and analysis library <span class="No-Break">for Python.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">langchain.llms.AzureOpenAI</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>A module from the “langchain” package for handling language models, specifically <span class="No-Break">Azure OpenAI.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">openai</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>The OpenAI Python library, which provides access to OpenAI’s <span class="No-Break">GPT models.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">os</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>Provides a way to interact with the operating system, including reading or setting <span class="No-Break">environment variables.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">dotenv.load_dotenv</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>Loads environment variables from a .env file into the <span class="No-Break">script’s environment.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">langchain_experimental.agents.agent_toolkits.</strong></p>
							<p class="IMG---Figure"><strong class="source-inline">create_spark_dataframe_agent</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>A function to create a Spark DataFrame agent for <span class="No-Break">experimental purposes.</span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style T---Body">
							<p class="IMG---Figure"><strong class="source-inline">langchain_experimental.agents.agent_toolkits.</strong></p>
							<p class="IMG---Figure"><strong class="source-inline">create_pandas_dataframe_agent</strong></p>
						</td>
						<td class="No-Table-Style T---Body">
							<p>A function to create a Pandas DataFrame agent for <span class="No-Break">experimental purposes.</span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption">Table 6.1: Explanation of the usage of the imported packages</p>
			<p>Now, let’s initialize all <a id="_idIndexMarker354"/>the necessary constants using the keys provided in the <strong class="source-inline">.env</strong> file. We add “<strong class="source-inline">DATABASESERVER</strong>” ,” <strong class="source-inline">DATABASE</strong>” , “<strong class="source-inline">DATABASEUSERNAME</strong>” and “<strong class="source-inline">DATABASEPASSWORD</strong>” to our .<strong class="source-inline">env</strong> file from <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a><span class="No-Break">.</span></p>
			<pre class="source-code">
# Azure
load_dotenv()
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
OPENAI_DEPLOYMENT_ENDPOINT =os.getenv("OPENAI_DEPLOYMENT_ENDPOINT")
OPENAI_DEPLOYMENT_NAME = os.getenv("OPENAI_DEPLOYMENT_NAME")
OPENAI_MODEL_NAME = os.getenv("OPENAI_MODEL_NAME")
OPENAI_API_VERSION = os.getenv("OPENAI_API_VERSION")
OPENAI_DEPLOYMENT_VERSION =os.getenv("OPENAI_DEPLOYMENT_VERSION")
server = os.getenv("DATABASESERVER")
database = os.getenv("DATABASE")
username = os.getenv("DATABASEUSERNAME")
password = os.getenv("DATABASEPASSWORD")
#init Azure OpenAI
openai.api_type = "azure"
openai.api_version = OPENAI_DEPLOYMENT_VERSION
openai.api_base = OPENAI_DEPLOYMENT_ENDPOINT
openai.api_key = OPENAI_API_KEY
load_dotenv()</pre>			<p>Add these to the <strong class="source-inline">.env</strong> file we<a id="_idIndexMarker355"/> created in <a href="B21019_04.xhtml#_idTextAnchor059"><span class="No-Break"><em class="italic">Chapter 4</em></span></a> with the <strong class="source-inline">connectionString</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">endpoints</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
DATABASESERVER = 'tcp :{server}, 1433'
DATABASE = '{name}'
DATABASEUSERNAME = '{username}'
DATABASEPASSWORD = '{password}'</pre>			<p>Follow these steps to<a id="_idIndexMarker356"/> add the SQL Server end point in the <strong class="source-inline">.env</strong> file. The required details can be found in your SQL server created in the azure portal in <strong class="bold">Connection Strings</strong> -&gt; <span class="No-Break"><strong class="bold">ODBC</strong></span><span class="No-Break"> section</span></p>
			<ol>
				<li>Update the <strong class="bold">DATABASESERVER</strong> value with the <strong class="bold">Server Name</strong> value found in your SQL <span class="No-Break">Database page.</span></li>
				<li>Similarly, modify the values of <strong class="source-inline">DATABASE</strong> with the <span class="No-Break">Database name.</span></li>
				<li>Similarly update the <strong class="bold">DATABASEUSERNAME</strong> and <strong class="bold">DATABASEPASSWORD</strong> you set while setting up <span class="No-Break">the database:</span></li>
			</ol>
			<div>
				<div id="_idContainer108" class="IMG---Figure">
					<img src="image/B21019_06_7.jpg" alt="Figure 6.7: Connection Strings"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.7: Connection Strings</p>
			<p>We get the <span class="No-Break">following output:</span></p>
			<pre class="source-code">
Out[2]:    True</pre>			<h2 id="_idParaDest-86"><a id="_idTextAnchor085"/>Setting DB Connection Strings</h2>
			<p>This code is a<a id="_idIndexMarker357"/> common pattern for connecting to a SQL Server database in Python using <strong class="source-inline">pyodbc</strong>, specifying connection parameters in the <strong class="source-inline">connectionString</strong>. The resulting connection (<strong class="source-inline">cnxn</strong>) and cursor (<strong class="source-inline">cursor</strong>) can be used to interact with the database through <span class="No-Break">SQL queries.</span></p>
			<pre class="source-code">
connectionString = f'DRIVER={{ODBC Driver 18 for SQL Server}};SERVER={server};DATABASE={database};UID={username};PWD={password};Encrypt=yes;TrustServerCertificate=no;Connection Timeout=30;'
cnxn = pyodbc.connect(connectionString)
cursor = cnxn.cursor()</pre>			<p>Now that we’ve incorporated the connection strings into our SQL database, it’s time to validate them by executing a sample query. In my experience I have seen several instances where developers struggle with getting the right connection string, the best way is to copy that directly from the source like azure portal and paste. Incase if you are formatting on your own then please take care if there are any special characters in either the password or <span class="No-Break">the username.</span></p>
			<p>This code snippet <a id="_idIndexMarker358"/>facilitates fetching a subset of data from the designated SQL table and visualizing it in a Pandas DataFrame, a typical procedure when handling data <span class="No-Break">in Python.</span></p>
			<pre class="source-code">
# select 10 rows from SQL table to insert in dataframe.
query = "select * from [SalesLT].[Address];"
df = pd.read_sql(query, cnxn)
print(df.head(10))</pre>			<p>We get the <span class="No-Break">following output:</span></p>
			<div>
				<div id="_idContainer109" class="IMG---Figure">
					<img src="image/B21019_06_8.jpg" alt="Figure 6.8: An overview of the Output of SQL Query"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.8: An overview of the Output of SQL Query</p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor086"/>Use the ChatGPT deployed model</h2>
			<p>From the previous output, we confirm that the<a id="_idIndexMarker359"/> SQL connection is established successfully, enabling us to execute database queries from our <span class="No-Break">Python code.</span></p>
			<p>The provided code snippet initializes an instance of the <strong class="source-inline">AzureOpenAI</strong> class, assuming that <strong class="source-inline">OPENAI_DEPLOYMENT_NAME</strong> and <strong class="source-inline">OPENAI_MODEL_NAME</strong> are variables storing the targeted deployment and model names, respectively, <span class="No-Break">for utilization.</span></p>
			<pre class="source-code">
llm = AzureOpenAI(deployment_name=OPENAI_DEPLOYMENT_NAME, 
    model_name=OPENAI_DEPLOYMENT_NAME)</pre>			<h3>Create Pandas agent and Ask Questions</h3>
			<p>In continuation from the previous step, the code initializes an experimental agent capable of natural language interaction with a Pandas DataFrame and a language model. It issues a query, “how many rows are there?”, anticipating the agent to interpret and respond accordingly based on <span class="No-Break">the DataFrame.</span></p>
			<pre class="source-code">
agent = create_pandas_dataframe_agent(llm, df, verbose=True)
x`</pre>			<p>We get the <span class="No-Break">following Output:</span></p>
			<div>
				<div id="_idContainer110" class="IMG---Figure">
					<img src="image/B21019_06_9.jpg" alt="Figure 6.9: Sample output of our agent creation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.9: Sample output of our agent creation</p>
			<p>Let’s now assess the effectiveness of our agent by experimenting with various prompts to retrieve data from the <span class="No-Break">SQL database.</span></p>
			<p>First Prompt: “What is the frequency of each <span class="No-Break">country region”</span></p>
			<pre class="source-code">
agent.run("what is the frequency of each country region")</pre>			<p>We get the <span class="No-Break">following output:</span></p>
			<div>
				<div id="_idContainer111" class="IMG---Figure">
					<img src="image/B21019_06_10.jpg" alt="Figure 6.10: SQL Output For our prompt"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.10: SQL Output For our prompt</p>
			<p>Second Prompt: “list the name of 10 <span class="No-Break">unique cities”</span></p>
			<pre class="source-code">
agent.run("list the name of 10 unique cities")</pre>			<p>We get the <span class="No-Break">following output:</span></p>
			<div>
				<div id="_idContainer112" class="IMG---Figure">
					<img src="image/B21019_06_11.jpg" alt="Figure 6.11: SQl Output for our prompt"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.11: SQl Output for our prompt</p>
			<p>Third Prompt: “how many unique state provinces <span class="No-Break">are there?”</span></p>
			<pre class="source-code">
agent.run("how many unique state provinces are there?")</pre>			<p>We get the <span class="No-Break">following output:</span></p>
			<div>
				<div id="_idContainer113" class="IMG---Figure">
					<img src="image/B21019_06_12.jpg" alt="Figure 6.12: SQL Output for our prompt"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.12: SQL Output for our prompt</p>
			<p>With this, we’ve successfully established the connection between SQL Server and ChatGPT. Now, instead of executing SQL queries directly, we can provide prompts to retrieve SQL data using Pandas DataFrame and <span class="No-Break">ChatGPT LLM.</span></p>
			<h1 id="_idParaDest-88"><a id="_idTextAnchor087"/>Summary</h1>
			<p>In this chapter, we delved into the effortless world of interacting with an SQL database using straightforward English prompts. First, we set the stage by creating a SQL database and establishing a seamless connection to it through the PyODBC library. We ensured the connectivity by testing simple <span class="No-Break">SQL queries.</span></p>
			<p>Moving forward, we introduced a powerful ally in the form of a Pandas agent driven using ChatGPT. This dynamic duo allows us to effortlessly make queries using everyday English prompts. In essence, this SQL GPT tool opens up a realm where anyone, regardless of prior SQL knowledge, can effortlessly extract data from the database. This is a game-changer, making the world of databases more accessible and user-friendly <span class="No-Break">for all.</span></p>
			<p>In the next chapter, we will look into how we can use Azure Open AI to generate code and documentation for the <span class="No-Break">user prompts.</span></p>
		</div>
	</body></html>