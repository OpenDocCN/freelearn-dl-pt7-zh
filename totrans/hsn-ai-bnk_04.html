<html><head></head><body>
        <section>

                            <header class="header-title chapter-title">
                    Time Series Analysis
                </header>
            
            <article>
                
<p class="mce-root">In the previous chapter, we introduced AI, machine learning, and deep learning. We also discovered how the banking sector functions and how the use of AI can enhance banking processes. We learned the importance of banking processes being easily accessible. We also learned about a machine learning modeling approach called <strong>CRISP-DM</strong>. Overall, the chapter provided the necessary background for the application of machine learning in the banking industry to solve various business problems.</p>
<p>In this chapter, we will learn about an algorithm that analyzes historical data to forecast future behavior, known as <strong>time series analysis</strong>. Time series analysis works on the basis of one variable—time. It is the process of capturing data points, also known as <strong>observations</strong>, at specific time intervals. The goal of this chapter is to understand time series analysis in detail through examples and explain how <strong>Machine-to-Machine</strong> (<strong>M2M</strong>) communication can be helpful in the implementation of time series analysis. We will also understand the concepts of financial banking as well.</p>
<p><span>In this chapter, w</span>e will cover the following topics :</p>
<ul>
<li>Understanding time series analysis</li>
<li>M2M communication</li>
<li>The basic concepts of financial banking</li>
<li>AI modeling techniques</li>
<li>Demand forecasting using time series analysis</li>
<li>Procuring commodities using neural networks on Keras</li>
</ul>
<h1 id="uuid-252b71db-e7b3-43b9-b2c7-84595c5f89d4">Understanding time series analysis</h1>
<p>A <strong>time series</strong> is technically defined as the ordered sequence of values of a variable captured over a uniformly spaced time interval. Put simply, it is the method of capturing the value of a variable at specific time intervals. It can be 1 hour, 1 day, or 20 minutes. The captured values of a variable are also known as <strong>data points</strong>. Time series analysis is performed in order to understand the structure of the underlying sources that produced the data. It is also used in forecasting, feedforward control, monitoring, and feedback. The following is a list of some of the known applications of time series analysis:</p>
<ul>
<li>Utility studies</li>
<li>Stock market analysis</li>
<li>Weather forecasting</li>
<li>Sales projections</li>
<li>Workload scheduling</li>
<li>Expenses forecasting</li>
<li>Budget analysis</li>
</ul>
<p>Time series analysis is achieved by applying various analytical methods to extract meaningful information from raw data that has been captured from various data sources. Time series analysis is also useful for producing statistics and other characteristics of data—for example, the size of data, the type of data, the frequency of data, and more. In time series analysis, the capturing of a value is done at a point of observation.</p>
<p><span>Let's try to understand this through an example. When using time series analysis modeling, the branch manager of a specific branch can predict or forecast the expenses that will occur in the upcoming year. The branch manager can do this by employing a time series analysis machine learning model and then training the model using historical yearly expense records. The recorded observations can be plotted on a graph with a specific time (each day, in this example) on the <em>x</em> axis and historical expenses on the <em>y</em> axis. Therefore, time series analysis is an algorithm that is used to forecast the future values of one variable (that is, yearly expenses in this example) based on the values captured for another variable (in this case</span><span>,</span><span> time).</span></p>
<p>Let's understand this in more detail using another example. In this example, we will imagine that a bank wants to perform expense projections based on the historical data it has. The bank manager wants to know and forecast the expenses in the year 2020 for the branch that he manages. So, the process of forecasting the expenses will start by collecting historical expenses information from the year 2000. First, the bank manager will look at the expenses data for the year.</p>
<p class="mce-root"/>
<p>As we mentioned earlier, time series analysis is done by capturing the values of a variable. Can you guess the variable in this example? I am sure that you will have guessed it by now. The variable under observation is the total expense amount per year. Let's assume that the following is the data per year:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p><strong>Year</strong></p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p><strong>Total expense (in USD)</strong></p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2000</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>20,000</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2001</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>22,500</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2002</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>21,000</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2003</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>18,000</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2004</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>25,700</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2005</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>22,100</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2006</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>23,300</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2007</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>17,600</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2008</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>18,200</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2009</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>20,400</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2010</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>21,200</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2011</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>20,900</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2012</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>22,600</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2013</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>17,500</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2014</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>19,300</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2015</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>20,100</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2016</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>22,200</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2017</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>22,500</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2018</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>19,400</p>
</td>
</tr>
<tr>
<td style="width: 44.7658%" class="CDPAlignCenter CDPAlign">
<p>2019</p>
</td>
<td style="width: 54.5455%" class="CDPAlignCenter CDPAlign">
<p>23,800</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Many options are available to analyze this data and predict future expenses. The analytical methods vary in terms of complexity. The simplest one will be to average out the expenses and assume the resultant value to be the number of expenses for the year 2020. However, this is solely for the purpose of our example. You can find the average of expenses by using various other mathematical and analytical methods as well. With this option, the total number of expenses for the year 2020 will be $20,915.</p>
<p>The complex method may involve analyzing detailed expenses, predicting future values for each individual expense type, and deriving the total expenses amount based on it. This may provide a more accurate prediction than the averaging option. You can apply a more complex analytical method based on your needs. This example is provided so that you can understand how time series analysis works. The amount of historical data that we have used in this example is very limited. AI and <span>machine learning </span>algorithms use large amounts of data to generate predictions or results. The following is a graphical representation of this example:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-945 image-border" src="assets/90ebad2e-e7a3-41dd-812e-6494224f4423.jpg" style="width:39.00em;height:24.17em;"/></p>
<p>In the following section, we will learn how machines can communicate with each other using a concept known as <strong>M2M communication</strong>.</p>
<h1 id="uuid-308932d8-e9b7-4528-9d74-2362a3c1136e">M2M communication</h1>
<p><span>M2M communication is extremely powerful and can dramatically improve the functions of commercial </span>banking.</p>
<p>M2M communication represents the communication between two machines or devices through various channels such as physical networks, information-sharing networks, software communication, and application interfaces. The sole purpose of M2M communication is the exchange of information across two or more machines or between software running on those machines.</p>
<p>The concept of M2M communication assumes that no human intervention is required while exchanging information between machines. M2M communication can also take place over wireless networks. Wireless networks have made M2M communication easier and more accessible. The following list includes several common applications of M2M communication:</p>
<ul>
<li>Manufacturing</li>
<li>Smart utility management</li>
<li>Home appliances</li>
<li>Healthcare device management</li>
</ul>
<p><span>However</span>, M2M communication is different from IoT. IoT uses sensors to trigger inputs, whereas M2M communication specifically refers to the interaction between two systems.</p>
<p>Commercial banking is a group of financial services that includes deposits, checking account services, loan services, drafts, certificates of deposits, and savings accounts for individuals and businesses. Commercial banks are the usual destination for peoples' banking needs. <em>But how do banks function and make money?</em> This is a very common question that we will answer right now. Commercial banks make money when they earn interest from various types of loans that they provide to their customers. The types of loans can vary, for example, automobile loans, business loans, personal loans, and mortgage loans. Usually, a commercial bank has a specialty in one or more types of loans.</p>
<p>Commercial banks get their capital from various types of account services that they provide to their customers. The types of accounts include checking accounts, savings accounts, corporate accounts, money market accounts, and more. Banks utilize this capital to invest in high-return investment options such as mutual funds, stocks, and bonds. Banks have to pay interest to those customers who have their accounts with the bank. The rate of interest is far less when compared to loans, however.</p>
<h2 id="uuid-c03aa3ac-4282-4538-9b29-0440c261de98">The role of M2M communication in commercial banking</h2>
<p>Consider an example that involves transferring money from one customer's account to another customer's account. In the past, this was a manual task that required filling in an appropriate form, submitting the form to the appropriate department where ledger entries were created, and then the amount was debited from one account and credited to the beneficiary's account.</p>
<p>Nowadays, this process has changed entirely. With a mobile phone, the customer can transfer funds from one account to another without any hassle. The beneficiary's account will be credited with the money within a few minutes. Incredible, isn't it? So, how did this happen? Well, M2M communication and process automation have played a major role in making this happen. It has become possible for machines (<span>that is,</span> computer systems, cloud-based virtual machines, and mobile devices) to connect over a wireless or wired network and transfer every piece of necessary information to another machine or software running on that machine. Nowadays, you only have to visit the bank for a few specific reasons. Customers can now even open a savings bank account or a loan account straight from their mobile devices.</p>
<h1 id="uuid-3464f5a9-e248-49ae-b401-30008ac1b847">The basic concepts of financial banking</h1>
<p>Before we move full steam ahead<span> </span>into another<span> </span>example,<span> </span>we will first craft out our data, AI, and business techniques and knowledge. If you are familiar with all of these concepts, feel free to skip this section.</p>
<p>Financial knowledge is a good place to start to understand how our decisions in forecasting business activities impact financial decision-making in non-financial firms. Additionally, when predicting future activities using a machine learning model, we also learn how the finance industry can prepare for this future volume of business. What financing does to help with core business activities in non-financial firms is covered in the following section.</p>
<h2 id="uuid-8970bca2-787b-439d-91c5-281c16413e92" class="mce-root">The functions of financial markets – spot and future pricing</h2>
<p class="mce-root">Financial markets, such as exchanges, play the role of markets for products to be exchanged. For example, consider commodities such as natural gas—we can either buy it directly from sellers or buy it via an exchange. As it turns out, long-running economics theories encourage you to buy the product from an exchange as much as possible if the product is standardized. <strong>Chicago Mercantile Exchange</strong> (<strong>CME</strong>) in the US could be a popular choice for commodities and, needless to say, the <strong>New York Stock Exchange</strong> (<strong>NYSE</strong>) is the market for publicly listed equities. </p>
<p class="mce-root">In this chapter, let's stick to natural gas as a product that we need. Of course, in some cases, it could be more efficient to buy it from big oil companies such as Shell—that is, if we want these physical goods from producers on a regular basis.</p>
<p>Within exchange markets, there are two prices— the spot price and the future price. <strong>Spot price</strong> means you can have goods (delivered) now if you pay; <strong>future price</strong> means you get the goods later by paying now.</p>
<h3 id="uuid-55396923-4e7b-4512-be19-f9d050efc4d9">Choosing between a physical delivery and cash settlement</h3>
<p>Even if a change in ownership is to take place, it could occur in two forms, that is, via physical delivery or a cash settlement. Ultimately, physical delivery or a cash settlement depends on whether we need the goods immediately or not. However, on any given trading day, we must weigh up the cost of only two options: <em>physical delivery (cost of natural gas + cost of financing + cost of storage) as opposed to a cash settlement</em>.</p>
<p>Essentially, we have four options, as presented in the following table—assuming that we need to have the physical natural gas product in 3 months time for the generation of electricity:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 71px" class="CDPAlignCenter CDPAlign"/>
<td style="width: 278px" class="CDPAlignCenter CDPAlign">
<p><strong>Physical delivery</strong></p>
</td>
<td style="width: 343px" class="CDPAlignCenter CDPAlign">
<p><strong>Cash settlement</strong></p>
</td>
</tr>
<tr>
<td style="width: 71px" class="CDPAlignCenter CDPAlign">
<p><strong>Spot</strong></p>
</td>
<td style="width: 278px" class="CDPAlignCenter CDPAlign">
<p>Finance the purchase to get the product now; store it for 3 months.</p>
</td>
<td style="width: 343px" class="CDPAlignCenter CDPAlign">
<p>Buy the product now and own it on paper. There is no need to keep the goods. </p>
</td>
</tr>
<tr>
<td style="width: 71px" class="CDPAlignCenter CDPAlign">
<p><strong>Future</strong></p>
</td>
<td style="width: 278px" class="CDPAlignCenter CDPAlign">
<p>Finance the purchase now to get the product in the future; get it in 3 months.</p>
</td>
<td style="width: 343px" class="CDPAlignCenter CDPAlign">
<p>Finance to buy the product in the future. 3 months later, purchase on spot from the market with physical delivery.</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p><span>To weigh up the options, we require the following data:</span></p>
<ul>
<li class="mce-root"><strong>Storage costs</strong> should be provided by the internal source if the company owns the storage facility for natural gas. It is assumed to be rather static, for example, at around 0.12 per <span>MMBtu. MMBtu is a unit used to measure the energy content in fuel. It stands for one <strong>Million British Thermal Units</strong>.</span></li>
<li class="mce-root">The <strong>financing cost</strong> should cover the storage period and the interest expenses for the purchase cost. It is assumed to be $0.1 per MMBtu. This should be fed by the bank.</li>
<li class="mce-root">The <strong>cost of natural gas</strong> (spot price) should be provided by the market data provider. The real-time Henry Hub spot price should be provided by Thomson Reuters, for example, at around $2.5 per MMBtu.</li>
<li class="mce-root">The <strong>cost of futures</strong> should be provided by CME. Data should be available on Quandl free of charge. It should be around $3 per MMBtu for 3-month contract.</li>
</ul>
<p>The numbers given here merely provide an indication of the magnitude of values. Of course, they could be optimized by comparing the options—however, the decisions can be derived by linear algebra, and not many <span>machine learning </span>techniques are needed. In real life, we should not impose a <span>machine learning solution</span> on anything if we can have a nice deterministic formula to do so.</p>
<h3 id="uuid-c0730221-4da2-4077-adc7-ff965bd9007b">Options to hedge price risk</h3>
<p>To avoid the price swinging outside the predefined price range of natural gas, we will need<span> </span>heuristic rules<span> </span>such as deciding what to do at what price given a fixed target purchase quantity. Alternatively, we need the rules to adjust what has been already placed to sell or buy more.</p>
<p>Take the following example. If the price is beyond the acceptable range, for example, lower than $2.84 or higher than $3.95, we can choose to pocket the profit by doing one of the following:</p>
<ul>
<li>Writing options (selling insurance) if the price drops a lot.</li>
<li>Reducing the loss by buying options (buying insurance) if the price shoots up unfavorably.</li>
</ul>
<p class="mce-root">The following<span> </span>diagram<span> </span>shows the per-unit payoff from the hedged position by buying insurance against the high procurement price and selling the benefits at a low procurement price:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-946 image-border" src="assets/4cb00173-c7a8-4eb2-b418-544488501838.png" style="width:34.75em;height:19.50em;"/></p>
<p class="mce-root">Here, we have sold insurance at an extremely low price—which means that even though we should have enjoyed a lower cost of procurement, we gave it away at the benefit of taking an insurance premium. On the other hand, there will be positive payoff when the price is too expensive, that may eat into the profitability of the company<span>—</span>by paying a premium to buy insurance. The exact price of the insurance is called option pricing and will be addressed in <a href="d29ff3a8-3879-4d50-8795-a39bae5cc793.xhtml">Chapter 7</a>, <em>Sensing Market Sentiment for Algorithmic Marketing at Sell Side</em>. We now assume that the price we pay for the insurance is the same as the price we earn from selling insurance.</p>
<h1 id="uuid-eec74789-d0a6-4662-9a78-84c84c8d1ea2">AI modeling techniques</h1>
<p>In the following sections, we will introduce the <strong>Autoregressive Integrated Moving Average</strong> (<strong>ARIMA</strong>), the most traditional type of forecasting model. We will also introduce a neural network model. ARIMA is a class of statistical models that is used to forecast a time series using past values. ARIMA is an acronym for the following:</p>
<ul>
<li><strong>AR</strong> (<strong>autoregression</strong>): Autoregression is a process that takes previous data values as inputs, applies this to the regression equation, and generates resultant prediction-based data values.</li>
<li><strong>I</strong> (<strong>integrated</strong>): ARIMA uses an integrated approach by using differences in observations to make the time series equally spaced. This is done by subtracting the observation from an observation on a previous step or time value.</li>
<li> <strong>MA</strong> (<strong>moving average</strong>): A model that uses the observation and the residual error applied to past observations. </li>
</ul>
<h2 id="uuid-14e748a5-2c44-415e-9630-31094b655e1d"><strong>Introducing the time series model – ARIMA</strong></h2>
<p>For this project, we will fit data into a time series model called<span> </span><strong>ARIMA</strong>. ARIMA is a specific type of time series model in statistics, which is commonly used to predict data points in the future, with parameters on autoregressive terms (<em>p</em>), non-seasonal differences (<em>d</em>), and lagged terms (<em>q</em>).</p>
<p>This ARIMA model belongs to parametric modeling—models that are fitted by known parameters. Normally, we classify this type of model as a statistical model because we need to make assumptions about what the data looks like. This is considerably different for wider <span>machine learning </span>models that do not have any preset assumptions about what the data looks like.</p>
<p>However, in a real banking scenario, a statistical approach is still prevalent among the econometrics, quantitative finance, and risk management domains. This approach works when we have a handful of data points, for example, around 30 to 100 data points. However, when we have a wealth of data, this approach may not fare as well as other <span>machine learning </span>approaches.</p>
<p class="mce-root">ARIMA assumes that there is a stationary trend that we can describe. The autoregressive terms, <em>p</em> and <em>d</em>, are each significant in their own way: </p>
<ul>
<li class="mce-root"><em>p</em><span> </span>means the number of past period(s) that is affecting the current period value (for example,<span> </span><em>p = 1: Y current period = Y current -1 period * coefficient + constant</em>).</li>
<li class="mce-root">Non-seasonal difference (<em>d</em>) refers to the number of past periods progression impacting the current period values (for example,<span> </span><em>d = 1</em>: the difference between<span> </span><em>Y</em> now versus<span> </span><em>Y</em><span> </span>in the past period).</li>
<li class="mce-root">Lagged terms (<em>q</em>) means the number of the past period's forecast errors impacting the current period values.</li>
</ul>
<p class="mce-root">Consider an example in which<span> </span><em>q = 1: Y</em><span> </span>impacted by an error in<span> the </span><em>t - 1</em><span> </span>period—here, error refers to the difference between the actual and predicted values.</p>
<p class="mce-root">In a nutshell, ARIMA specifies how the previous period's coefficient, constant, error terms, and even predicted values impact the current predicted values. It sounds scary, but it is, in fact, very understandable.</p>
<p>After the model is fit, it will be asked to make a prediction and be compared against the actual testing data. The deviation of the prediction from the testing data will record the accuracy of the model. We will use a metric called the<span> </span><strong>Mean Square Error</strong><span> </span>(<strong>MSE</strong>) in this chapter to determine the fitness of the model to the data.</p>
<h2 id="uuid-8edbc9fc-87a8-491e-b7a0-1b6c44748670">Introducing neural networks – the secret sauce for accurately predicting demand</h2>
<p>We may have a good data source, but we should not forget that we also need a smart algorithm. You may have read about neural networks thousands of times, but let's look at a short explanation before we use them extensively throughout the book. A neural network is an attempt by a computer to mimic how our brain works—it works by connecting different computing points/neurons with different settings.</p>
<p class="mce-root">Architecture-wise, it looks like layers of formulas. Those of you reading this book probably have some background in algebra, and can see how the interested outcome<span> </span><em>Y</em><span> </span>is related to<span> </span><em>X</em><span>, </span>the variable, with <em>b</em> being the coefficient and <em>c</em> being the constant term:</p>
<p class="mce-root CDPAlignCenter CDPAlign"><img class="fm-editor-equation" src="assets/c5eb98bf-4c05-4d02-9ccf-9d61d6cbac22.png" style="width:6.00em;height:1.08em;"/></p>
<p class="mce-root"><em>Y</em><span> </span>is what we wish to predict on the left-hand side; on the right-hand side,<span> </span><em>bX + c</em><span> </span>are the forms that describe how the feature (<em>X</em>) is related to<span> </span><em>Y</em>. In other words,<span> </span><em>Y</em><span> </span>is the output, while<span> </span><em>X</em><span> </span>is the input. The neural network describes the relationship between the input and the output.</p>
<p class="mce-root">Suppose<span> that </span><em>Z</em><span> </span>is what we want to predict:</p>
<p class="mce-root CDPAlignCenter CDPAlign"><img class="fm-editor-equation" src="assets/e582ab05-9812-4fb9-bf27-7931cad554a0.png" style="width:6.00em;height:1.08em;"/></p>
<p class="mce-root">It seems that the formulas are linked:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1092 image-border" src="assets/30df07a7-15f5-4c36-a4e8-8e274f6dfad2.png" style="width:30.58em;height:9.92em;"/></p>
<p>This is the simplest form of a neural network, with one input layer, one hidden layer, and one output layer. Each of the layers has one neuron (point).</p>
<div class="packt_infobox">I encourage you to read research papers and introductory text on machine learning or even enroll<span> </span>yourself for online courses. Useful resources from Packt include <span>Sebastian Raschka and Vahid Mirjalili's <em>Python Machine Learning</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition">https://www.packtpub.com/big-data-and-business-intelligence/python-machine-learning-second-edition</a>) and Rowel Atienza's <em>Advanced Deep Learning with</em> <em>Keras</em> (<a href="https://www.packtpub.com/big-data-and-business-intelligence/advanced-deep-learning-keras">https://www.packtpub.com/big-data-and-business-intelligence/advanced-deep-learning-keras</a>)<em>.</em></span></div>
<h3 id="uuid-a1c43102-8111-41bb-ab31-c42b8ec1c75f" class="mce-root">Backpropagation</h3>
<p>There are other concepts in neural networks, such as backpropagation. This refers to the feedback mechanism that fine-tunes the neural network's parameters, which mostly connect neurons within the network (except when it is a constant parameter at the layer). It works by comparing the output at output layer<span> </span><em>Z</em><span> </span>(predicted) versus the actual value of <em>Z</em> (actual). The wider the gap between actual and predicted, the more adjustment of <em>b</em>, <em>c</em>, <em>d</em>, and <em>e</em> is needed.</p>
<p>Understanding how gaps are measured is also an important<span> piece of </span>knowledge—this is called <strong>metrics</strong> and will be addressed in <a href="61949743-f7c3-4295-aaee-dab1d169d25c.xhtml">Chapter 3</a>, <em>Using Features and Reinforcement Learning to Automate Bank Financing.</em></p>
<h3 id="uuid-64adf877-538a-47bb-acd9-bba131b70545">Neural network architecture</h3>
<p class="mce-root">Architecture concerns the layers and number of neurons at each layer, as well as how the neurons are interconnected in a neural network. The input layer is represented as <strong>features</strong>. The output layer can be a single number or a series of numbers (called a <strong>vector</strong>), which generates a number ranging from 0 to 1 or a continuous value—subject to the problem domain.</p>
<p class="mce-root">For example, to understand the structure of a neural network, we can project that it will look like the following screenshot from TensorFlow Playground (<a href="https://playground.tensorflow.org/">https://playground.tensorflow.org/</a>), which is the visualization of another network with the same hidden layers—three layers with a size of 6:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1150 image-border" src="assets/2225db38-32a7-49d4-9d47-930cd76d6e65.png" style="width:184.33em;height:91.67em;"/></p>
<h3 id="uuid-ba8faa48-f9bc-4d66-83a7-32575759eaf4">Using epochs for neural network training</h3>
<p class="mce-root">Besides the design of the neural network, we also utilize the<span> </span><kbd>epoch</kbd><span> </span>parameter, which indicates the number of times the same set of data is fed to the neural network.</p>
<p class="mce-root">We need to increase the number of epochs if we do not have enough data to satisfy the number of parameters in neural networks. Given that we have <em>X</em> parameters in the neural network, we need at least <em>X</em> data points to be fed to the network. Unfortunately, if our data point is only <em>X</em>/2, we need to set <kbd>epoch</kbd> to 2 in order to make sure that we can feed <em>X</em> data points (all of them are fed twice) to the network.</p>
<h3 id="uuid-ab6f315c-9e6f-476f-9069-82188b83ecbd">Scaling</h3>
<p>Before feeding the features to the machine learning model, we will normalize the input features of different magnitudes to be of the same magnitude. For example, the price and volume of goods are different types of numeric data. The scaling process will make sure that both of them are scaled to the same range, from 0 to 1. In classical statistical modeling processes, this step is very important to avoid a particular feature of bigger scales that dominate the influence on the prediction.</p>
<h3 id="uuid-7361c154-96d1-4138-85df-0041b21aead8">Sampling</h3>
<p>Apart from data column-level scaling, we also need to pay attention to the sampling bias of the model. Normally, we will set aside a portion of the data unseen by the machine while it is training and learning on another set of data—which is called a <strong>training set</strong>. Later on, the testing set (which is the dataset kept aside) will be used to check against the prediction made by the model.</p>
<h1 id="uuid-586ddfb4-f77a-4789-8575-ff4787a2553e">Demand forecasting using time series analysis</h1>
<p>In this section, we will take a look at the first example of forecasting the demand for electricity consumption, and predict the energy expenses using time series analysis. We will start with a brief problem statement and define steps to solve the problem. This will give you a better understanding of how to find solutions to problems using time series analysis.</p>
<p>Today, electricity or energy is a very basic necessity for all of us. We use electricity and pay bills. Now, as a customer, we want to analyze electricity consumption and predict future consumption and predict energy expenses. This is the problem that we will solve in this section.</p>
<p>Time series analysis is the optimal approach for solving problems similar to the one defined in the preceding problem statement. Machine learning models need large datasets to be fed before the actual solution is derived. These large datasets are used by machine learning models to derive a pattern or identify an existing pattern that might not be visible when the data is scattered. Similarly, our first step would be to obtain a large amount of data and process it to extract meaningful information. This is going to be a three-step process. Here are the steps that we will follow:</p>
<ol>
<li>Downloading the data</li>
<li>Preprocessing the data</li>
<li>Model fitting the data</li>
</ol>
<h2 id="uuid-ac0b4c05-a4bb-4e97-92cb-1c88a4ed59ea">Downloading the data</h2>
<p>Start by downloading data regarding electricity consumption and energy expenses. Even though we can download data from public websites now, in a true production environment, it is not uncommon to download data from an internal database and pass it to users as a flat file (a text file with no database structure).</p>
<p class="mce-root">You can download the files from the following paths:</p>
<ul>
<li><strong>Consumption</strong>: <a href="https://www.eia.gov/opendata/qb.php?category=873&amp;sdid=ELEC.CONS_TOT.NG-CA-98.M">https://www.eia.gov/opendata/qb.php?category=873&amp;sdid=ELEC.CONS_TOT.NG-CA-98.M</a></li>
<li><strong>Cost</strong>: <a href="https://www.eia.gov/opendata/qb.php?category=41625&amp;sdid=ELEC.COST.NG-CA-98.M">https://www.eia.gov/opendata/qb.php?category=41625&amp;sdid=ELEC.COST.NG-CA-98.M</a></li>
<li><strong>Revenue</strong>: <a href="https://www.eia.gov/opendata/qb.php?category=1007&amp;sdid=ELEC.REV.CA-RES.M" target="_blank">https://www.eia.gov/opendata/qb.php?category=1007&amp;sdid=E LEC.REV.CA-RES.M</a></li>
</ul>
<p>There are many ways of obtaining data, for example, using an API or robots. We will address these other methods of extracting data as we move further into the book. In <a href="0c281efb-a1b8-423f-976b-0fa47f5da990.xhtml">Chapter 4</a>,<span> </span><em>Mechanizing Capital Market Decisions,</em> we'll obtain data through an API call. If we were to use a robot, for example, we could have used <strong>Beautiful Soup</strong> to parse the website or register the API. However,<span> </span>in this example, we simply visit the site using a browser and navigate to the download<span> </span>button to download the data.</p>
<h2 id="uuid-2ff81f39-22c9-40c0-be7e-ecbff7dd691c">Preprocessing the data</h2>
<p><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158">After we obtain the data, we align it together in the same time series, as the data we've downloaded can cover different periods of time. As data scientists, we strive to align our data in one single sheet of data, with all of the required data listed column by column (that is, cost, consumption, sales, and more):</span></span></p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1151 image-border" src="assets/80f80a27-42ee-4915-a5bb-7de60f89f01a.png" style="width:34.00em;height:22.33em;"/></p>
<p><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158"><span>Each line (or row)</span><span> </span><span>of the data should represent a single </span>month.</span></span><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158"><span> </span></span></span><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158">Right before we feed our data for the machine to learn the patterns, we will need to set aside some data for testing and some for learning. With the testing data, we can see whether the model predicts well, without training on the learning data first. This is a fundamental step in all ML/predictive models. We do not feed the testing dataset for ML/trai</span></span><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158">ning. The line that calls the function is as follows:</span></span></p>
<pre><span class="LineBreakBlob BlobObject DragDrop SCXW126615158">file_path_out<br/>if select_fld:<br/>    list_flds = ['consumption_ng','avg_cost_ng']<br/>    tuple_shape_list = [(8,0,3),(12,1,3)]<br/>else:<br/>    list_flds = preprocess_data(f_name,list_flds)</span></pre>
<p class="mce-root"><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158">In this program, we set aside the earliest 70% of data points as training data for the machine to learn and adapt to, while keeping the latter 30% of data points as testing data. This is data that will be used to compare against the prediction made by the model,</span></span> <span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158">not used to f</span></span><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158">it the data</span></span><span class="TextRun SCXW126615158"><span class="NormalTextRun SCXW126615158">.</span></span><span class="EOP SCXW126615158"> </span></p>
<h2 id="uuid-201d9528-8060-48c8-8271-a09e9ed3fd34">Model fitting the data</h2>
<p>Once the data is clean, we will start training the machine to learn about the pattern. The training data will be fed to the machine as fitting. The model is like a shirt and the training data is like the body we're attempting to fit it to.</p>
<p>Here are the steps to fit our data into an ARIMA model:</p>
<ol>
<li>For each data file/field in the consolidated file, we run <em>step 3</em> and <em>step 4</em> (which have been marked in the code file for the following code block).</li>
<li>If the Boolean variable, <kbd>parameter_op</kbd>, is set to <kbd>True</kbd>, then we will run <em>step 5</em> (which is marked as well). This explores all the possible combinations of parameters in ARIMA with regard to <kbd>p</kbd>, <kbd>d</kbd>, and <kbd>q</kbd>, which are set as follows:</li>
</ol>
<ul>
<li style="padding-left: 30px"><kbd>p</kbd>: Ranging from 0<span> </span>to 12</li>
<li style="padding-left: 30px"><kbd>d</kbd>: Ranging from 0 to 2</li>
<li style="padding-left: 30px"><kbd>q</kbd>: Ranging from 0 to 3</li>
</ul>
<ol start="3">
<li>For combinations of any of the preceding values, we calculate the fitness of the data to the actual pattern and measure the error values. The combinations with the lowest error values are selected as the chosen parameters of the ARIMA model.</li>
</ol>
<p>The following is the code snippet to fine-tune the parameters used (please refer to the full code file on GitHub: <a href="https://github.com/PacktPublishing/Hands-On-Artificial-Intelligence-for-Banking">https://github.com/PacktPublishing/Hands-On-Artificial-Intelligence-for-Banking</a>):</p>
<pre>start = time.time()<br/>lowest_MSE=99999999999<br/>lowest_order = (0,0,0)<br/>for p_para in range(13):<br/>  for d_para in range(3):<br/>    for q_para in range(4):<br/>      order = (p_para,d_para,q_para)<br/>      ...<br/>      ...<br/>      error,temp_data,temp_model = forecasting(dta_df, fld, False, \<br/>                                               order, 0.7, fld)<br/><br/>if error&lt;lowest_MSE:<br/>  lowest_MSE=error<br/>  lowest_order = order<br/>  lowest_data = temp_data<br/>  lowest_model = temp_model<br/>  end = time.time()<br/>  ...</pre>
<p>Congratulations! We have now delivered a model that can provide volume forecasts for the future!</p>
<h1 id="uuid-5bee7685-531d-40de-b32e-51ee621c2933">Procuring commodities using neural networks on Keras</h1>
<p>In this section, we will take a look at another more complex example. As before, we will define the problem statement and then define steps to solve the problem. </p>
<p>In this example, we want to forecast the procurement of commodities based on historical data. The commodity that we are going to use is natural gas. In the case of natural gas, we do not have any control over its pricing because it is a hugely globalized commodity. However, we can still set up the internal procurement strategy when the pricing of the natural gas hits a certain range. The profitability ratio target will <span><span>constrain </span></span>the maximum pricing we can pay for the raw material to be profitable for the owners of the firm. We will track the profitability ratio, which is the ratio of cost of natural gas to sales. </p>
<p class="mce-root">Let's understand this pricing constraint with an example. In this example, we assume that for each dollar spent where the unit cost of natural gas (for electric power) increased, the cost of materials to sales of the energy company will increase by <strong>9.18%</strong> (this is based on 3 years of data):</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1156 image-border" src="assets/6a26e3a0-4c56-4591-9a36-5147ead969ee.png" style="width:29.67em;height:19.75em;"/></p>
<p><span>The following table shows the weighted average for sales on an annual basis:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-948 image-border" src="assets/761ff695-2f42-4796-b6ec-f358d0014b85.png" style="width:47.08em;height:8.08em;"/></p>
<p><span>Here, you can see the cost of natural gas to sales from <strong>2015</strong> to <strong>2017</strong>. In <strong>2017</strong>, at an average unit weight of <strong>$3.91</strong>, the cost of natural gas to sales is at <strong>36.45%</strong>. We assume that the average unit weight and cost to sales are in a constant relationship—averaging the values of the cost of materials rate across the years (from <strong>2015</strong>-<strong>2017</strong>, that is, <strong>7.66%</strong>, <strong>9.32%</strong>, and <strong>9.66%</strong>). We took an average of all three figures to come to a weighted average of <strong>9.18%</strong>.</span></p>
<p class="mce-root">Remember, the actual number should, in practice, come from the internal accounting system, not the external US <strong>Energy Information Administration</strong> (<strong>EIA</strong>) data that is used only for the purpose of electric power.</p>
<p class="mce-root">Based on the last 3 years of data, we find that the average cost of materials to sales stood at 31.15% (the average of <span class="packt_screen">iii</span> from the table), which translates into $3.39 million/thousand cubic feet. The cost of the material of sales is at 36.24% with the unit cost at $3.95 million/mcf in the upper range. The <strong>mcf</strong> is a standard unit cost of natural gas. It is equal to a thousand cubic feet. However, at the lower range, the cost of the material of sales is 26.07% with the unit cost at $2.84 million/mcf. The unit conversion details can be found on the EIA website.</p>
<p class="mce-root">Data is extracted from the preceding sales figure table: <em>Operating Expenses/Operating Revenues = cost of materials to sales</em>.</p>
<p class="mce-root">After we have established the procurement plan, we then need to understand where to source the natural gas from. In real life, we would consider how the model's insight gets executed; perhaps we also need to build a model to make the subsequent decision on how the model's insights get executed. This is exactly what we have mentioned in business understanding on how to execute the order in exchange markets.</p>
<p class="mce-root">To complete this story, we assume that we purchase the natural gas from the exchange markets using physical deliveries whenever the price hits the target range for the quantity we forecasted.</p>
<h2 id="uuid-311ff2bc-12b2-48fb-82d8-6eebd1a04707">Data flow</h2>
<p>The following data flow outlines the steps we need to take in order to prepare and generate the<span> </span>code to build the commodity procurement model. The first box denotes a script run on the SQLite database; the other boxes denote steps run on Python:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1093 image-border" src="assets/de546535-10d8-4539-af24-fe10f04bb9f7.png" style="width:161.67em;height:13.00em;"/></p>
<div style="font-weight: 400">
<p>It generally fits into the framework of<span> </span>CRISP-DM,<span> </span>with different areas of focus throughout this book—some may focus on understanding the business, while some may focus on evaluation.<span> The steps in the preceding diagram are covered in detail in the following sections.</span></p>
</div>
<h3 id="uuid-c5268009-5714-4996-b93e-c3d23ab6d84f">Preprocessing the data (in the SQL database)</h3>
<p><span>Data preprocessing means converting the data into the desired data features. We run it outside of Python coding to reduce the layers involved (that is, we interact directly with SQLite rather than using Python to interact with SQLite). Here are the steps involved in performing database operations:</span></p>
<ol>
<li>Create the SQLite database.</li>
<li>Import the data as a staging table.</li>
<li>Create the required table(s)—a one-time operation.</li>
<li>Insert the staging table into the actual table with data type and format transformation.</li>
<li>Create the view that does the feature engineering.</li>
<li>Output the preprocessed view as CSV data.</li>
</ol>
<h3 id="uuid-970de767-41eb-412f-9977-26598c6aa6d0">Importing libraries and defining variables</h3>
<p>Import libraries and define variables to make sure that the relevant functions can be used. Import all of the relevant libraries:</p>
<ul>
<li><kbd>pandas</kbd>: This is for data storage before data is fed to the <span>machine learning </span>module.</li>
<li><kbd>keras</kbd>: This an easy-to-use <span>machine learning </span>framework that has another library.</li>
<li><kbd>tensorflow</kbd>: This is used as the backend.</li>
<li><kbd>sklearn</kbd>: This is a very popular machine learning module that provides lots of data preprocessing toolkits along with some machine learning models that are easy to use. The models are not used in this example, as we wish to build up the foundation for the more extensive use of machine learning models afterward. In addition, <kbd>sklearn</kbd> also has metrics that appraise the performance of the models.</li>
<li><kbd>matplotlib</kbd>: This is the default data visualization tool.</li>
</ul>
<p>The following code block is the code importing all the listed libraries:</p>
<pre class="mce-root">'''*************************************<br/>2. import all the libraries required<br/>'''<br/>import pandas as pd<br/><br/>from keras.models import Model<br/>from keras.layers import Dense, Input<br/>from sklearn.preprocessing import StandardScaler<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import mean_squared_error<br/><br/>import matplotlib.pyplot as plt<br/><br/>import pickle<br/><br/>demand_model_path = 'demand_model.h5'<br/>f_in_name = 'consumption_ng_exp.csv'</pre>
<h3 id="uuid-9327c15f-56c3-4d3a-a423-5c5d2a85bf8d">Reading in data</h3>
<p><span class="TextRun SCXW10404229"><span class="NormalTextRun SCXW10404229">The following is the code snippet to read in the data and take on the result generated from <em>step 1</em>:</span></span></p>
<pre>'''*************************************<br/>#Read in data<br/>'''<br/>pd_trade_history = pd.read_csv(f_in_name,header=0)<br/>pd_trade_history = pd_trade_history.drop('date_d',1)  </pre>
<h3 id="uuid-d208deb9-0393-450a-be72-efed1b54672e">Preprocessing the data (in Python)</h3>
<p>Now we come to data preprocessing in Python. Some studies claim that data scientists spend 80% of their time on this step! It includes selecting features and target variables, checking/validating data types and handling missing values (this component is not included in this example to reduce complexity), and splitting data into a training set and a testing set. In some cases, when the ratios of the various classes of targets are not similar in quantity, we may need to do stratified sampling to ensure that balanced training samples are fed for machine learning. In this example, we set aside 20% for testing and 80% for training:</p>
<pre class="mce-root">'''*************************************<br/>4. Pre-processing data<br/>'''<br/>#4.A: select features and target<br/>df_X = pd_trade_history.iloc[:,:-5]<br/>df_Y = pd_trade_history.iloc[:,-4:]<br/><br/>np_X = df_X.values<br/>np_Y = df_Y.values<br/><br/>#4.B: Prepare training and testing set<br/>X_train, X_test, Y_train, Y_test = train_test_split(np_X, np_Y, \<br/>                                                    test_size = 0.2)<br/><br/>#4.C: scaling the inputted features<br/>sc_X = StandardScaler()<br/>X_train_t = sc_X.fit_transform(X_train)<br/>X_test_t = sc_X.fit_transform(X_test)</pre>
<h3 id="uuid-716e7400-8558-4c2b-86c0-934aef9cf5dc">Training and validating the model</h3>
<p>We train the neural network by feeding the training dataset to generate a model. The following code snippet defines the machine learning model in Keras and trains it. It builds the deep neural network model with 329 parameters:</p>
<pre>'''*************************************<br/>#5. Build the model<br/>'''<br/>inputs = Input(shape=(14,))<br/>x = Dense(7, activation='relu')(inputs)<br/>x = Dense(7, activation='relu')(x)<br/>x = Dense(7, activation='relu')(x)<br/>x = Dense(4, activation='relu')(x)<br/>x = Dense(4, activation='relu')(x)<br/>x = Dense(4, activation='relu')(x)<br/>x = Dense(4, activation='relu')(x)<br/>predictions = Dense(units=4, activation='linear')(x)<br/>demand_model= Model(inputs=inputs,outputs=predictions)<br/>demand_model.compile(loss='mse', optimizer='adam', metrics=['mae'])<br/><br/>demand_model.fit(X_train_t,Y_train, epochs=7000, validation_split=0.2)<br/><br/>Y_pred = demand_model.predict(X_test_t)<br/><br/>#conver numpy as dataframe for visualization<br/>pd_Y_test = pd.DataFrame(Y_test)<br/>pd_Y_pred = pd.DataFrame(Y_pred)</pre>
<h3 id="uuid-7f7a9640-0df5-4c79-bd8e-7715dc95dd7c">Testing the model</h3>
<p>We will compare the data points set aside (<span>20%)</span> in <em>step 4</em> against the predicted outcome based on the models trained and the features data:</p>
<pre>'''*************************************<br/>##6. Test model: Measure the model accuracy<br/>combine both actual and prediction of test data into data<br/>'''<br/>data = pd.concat([pd_Y_test,pd_Y_pred], axis=1)<br/>data_name = list(data)[0]<br/>data.columns=['actual1','actual2','actual3','actual4','predicted1', \<br/>              'predicted2','predicted3','predicted4']<br/><br/>error1 = mean_squared_error(data['actual1'],data['predicted1'])<br/>print('Test MSE 1: %.3f' % error1)<br/>error2 = mean_squared_error(data['actual2'],data['predicted2'])<br/>print('Test MSE 1: %.3f' % error2)<br/>error3 = mean_squared_error(data['actual3'],data['predicted3'])<br/>print('Test MSE 1: %.3f' % error3)<br/>error4 = mean_squared_error(data['actual4'],data['predicted4'])</pre>
<h3 id="uuid-91637114-ca85-494d-8683-796f62be423f"><span>Visualizing the test result</span></h3>
<p><span>This step allows us to cross-check the metrics that represent the performance of the model—the MSE:</span></p>
<pre>'''*************************************<br/>#7. Visualize the prediction accuracy<br/>'''<br/><br/>data.actual1.plot(color='blue',grid=True,label='actual1',title=data_name)<br/>data.predicted1.plot(color='red',grid=True,label='predicted1')<br/>plt.legend()<br/>plt.show()<br/>plt.close()<br/><br/>...</pre>
<p>This will result in the following plot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/676dc5bf-04f0-4c0e-97c3-745d6b7c9508.png" style="width:33.33em;height:24.83em;"/></p>
<h3 id="uuid-1b68b777-f63e-4bd6-b1ba-b6cd42154184">Generating the model for production</h3>
<p>The model that was trained and tested in <em>steps 5</em> and <em>6</em> will be output as a file for the production system to run on unseen production data. We will output two files—one for scaling the input features and another one for the neural network:</p>
<pre>'''*************************************<br/>#8. Output the models<br/>'''<br/>demand_model.summary()<br/>demand_model.save(demand_model_path)<br/>f_scaler=open('x_scaler.pkl',"wb+")<br/>pickle.dump(sc_X, f_scaler)</pre>
<p>Congratulations! We have now delivered a model that can be used at the operational level to identify the quantity to order for this month's demand, next month, and the month after. The following diagram shows the steps in the training versus the deployment of machine learning models:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1094 image-border" src="assets/f49bd5d6-8529-4a66-8fae-8c9f7fdc7cf8.png" style="width:132.08em;height:28.67em;"/></p>
<p>However, we are not going to cover deployment right now. We will keep this in mind and address the topic as we progress in this book. We will explore wrapping the AI production solution as an API in <a href="064a80f9-0636-4b3f-aed3-e2fee86ed7af.xhtml">Chapter 8</a>, <em>Building Personal Wealth Advisers with Bank APIs</em>.</p>
<h1 id="uuid-71c76724-3d9a-49d0-8bcf-ac1e7b290ea9">Summary</h1>
<p>In this chapter, you learned about time series analysis, M2M communication, and the benefits of time series analysis for commercial banking. We also looked at two useful examples by defining the problem statement and deriving the solution step by step. We also learned about the basic concepts of time series analysis and a few techniques, such as ARIMA. </p>
<p>In the next chapter, we will explore reinforcement learning. Reinforcement learning is an area of machine learning involving algorithms. The application takes an appropriate action to maximize the effectiveness of the outcome in a particular situation. We will also look at how to automate decision-making in banking using reinforcement learning. Exciting, isn't it?</p>


            </article>

            
        </section>
    </body></html>