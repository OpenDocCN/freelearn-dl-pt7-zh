["```py\npip install pyspark\n```", "```py\nimport pyodbc\nimport pandas as pd\nfrom langchain.llms import AzureOpenAI\nimport openai\nimport os\nfrom dotenv import load_dotenv\nfrom langchain_experimental.agents.agent_toolkits import (\n    create_spark_dataframe_agentimport openai)\n```", "```py\n# Azure\nload_dotenv()\nOPENAI_API_KEY = os.getenv(\"OPENAI_API_KEY\")\nOPENAI_DEPLOYMENT_ENDPOINT =os.getenv(\"OPENAI_DEPLOYMENT_ENDPOINT\")\nOPENAI_DEPLOYMENT_NAME = os.getenv(\"OPENAI_DEPLOYMENT_NAME\")\nOPENAI_MODEL_NAME = os.getenv(\"OPENAI_MODEL_NAME\")\nOPENAI_API_VERSION = os.getenv(\"OPENAI_API_VERSION\")\nOPENAI_DEPLOYMENT_VERSION =os.getenv(\"OPENAI_DEPLOYMENT_VERSION\")\nserver = os.getenv(\"DATABASESERVER\")\ndatabase = os.getenv(\"DATABASE\")\nusername = os.getenv(\"DATABASEUSERNAME\")\npassword = os.getenv(\"DATABASEPASSWORD\")\n#init Azure OpenAI\nopenai.api_type = \"azure\"\nopenai.api_version = OPENAI_DEPLOYMENT_VERSION\nopenai.api_base = OPENAI_DEPLOYMENT_ENDPOINT\nopenai.api_key = OPENAI_API_KEY\nload_dotenv()\n```", "```py\nDATABASESERVER = 'tcp :{server}, 1433'\nDATABASE = '{name}'\nDATABASEUSERNAME = '{username}'\nDATABASEPASSWORD = '{password}'\n```", "```py\nOut[2]:    True\n```", "```py\nconnectionString = f'DRIVER={{ODBC Driver 18 for SQL Server}};SERVER={server};DATABASE={database};UID={username};PWD={password};Encrypt=yes;TrustServerCertificate=no;Connection Timeout=30;'\ncnxn = pyodbc.connect(connectionString)\ncursor = cnxn.cursor()\n```", "```py\n# select 10 rows from SQL table to insert in dataframe.\nquery = \"select * from [SalesLT].[Address];\"\ndf = pd.read_sql(query, cnxn)\nprint(df.head(10))\n```", "```py\nllm = AzureOpenAI(deployment_name=OPENAI_DEPLOYMENT_NAME, \n    model_name=OPENAI_DEPLOYMENT_NAME)\n```", "```py\nagent = create_pandas_dataframe_agent(llm, df, verbose=True)\nx`\n```", "```py\nagent.run(\"what is the frequency of each country region\")\n```", "```py\nagent.run(\"list the name of 10 unique cities\")\n```", "```py\nagent.run(\"how many unique state provinces are there?\")\n```"]