["```py\npython_dep_location = sess.upload_data(path='python.zip', bucket=default_bucket, key_prefix='sagemaker/inference-pipeline/dependencies/python')   \n\njar_dep_location = sess.upload_data(path='mleap_spark_assembly.jar', bucket=default_bucket, key_prefix='sagemaker/inference-pipeline/dependencies/jar') \n```", "```py\nargs = getResolvedOptions(sys.argv, ['S3_INPUT_BUCKET',\n 'S3_INPUT_KEY_PREFIX',\n 'S3_INPUT_FILENAME',\n 'S3_OUTPUT_BUCKET',\n 'S3_OUTPUT_KEY_PREFIX',\n 'S3_MODEL_BUCKET',\n 'S3_MODEL_KEY_PREFIX'])\n```", "```py\nabcnewsdf = spark.read.option(\"header\",\"true\").csv(('s3://' + os.path.join(args['S3_INPUT_BUCKET'], args['S3_INPUT_KEY_PREFIX'], args['S3_INPUT_FILENAME'])))\n```", "```py\nabcnewsdf = abcnewsdf.limit(hdl_fil_cnt) \n\ntok = Tokenizer(inputCol=\"headline_text\", outputCol=\"words\") \nswr = StopWordsRemover(inputCol=\"words\", outputCol=\"filtered\")\nctv = CountVectorizer(inputCol=\"filtered\", outputCol=\"tf\", vocabSize=200, minDF=2)\nidf = IDF(inputCol=\"tf\", outputCol=\"features\")\n```", "```py\nnews_pl = Pipeline(stages=[tok, swr, ctv, idf])\nnews_pl_fit = news_pl.fit(abcnewsdf)\nnews_ftrs_df = news_pl_fit.transform(abcnewsdf)\n```", "```py\nnews_save = news_formatted.select(\"result\")\nnews_save.write.option(\"delimiter\", \"\\t\").mode(\"append\").csv('s3://' + os.path.join(args['S3_OUTPUT_BUCKET'], args['S3_OUTPUT_KEY_PREFIX']))\n```", "```py\n SimpleSparkSerializer().serializeToBundle(news_pl_fit, \"jar:file:/tmp/model.zip\", news_ftrs_df)\ns3.Bucket(args['S3_MODEL_BUCKET']).upload_file('/tmp/model.tar.gz', file_name)\n```", "```py\nresponse = glue_client.create_job(\n    Name=job_name,\n    Description='PySpark job to featurize the ABC News Headlines dataset',\n    Role=role,\n    ExecutionProperty={\n        'MaxConcurrentRuns': 1\n    }, \n```", "```py\nCommand={\n'Name': 'glueetl',\n'ScriptLocation': script_location\n},\n```", "```py\nDefaultArguments={\n'--job-language': 'python',\n'--extra-jars' : jar_dep_location,\n'--extra-py-files': python_dep_location\n},)\n```", "```py\njob_run_id = glue_client.start_job_run(JobName=job_name,\n                                       Arguments = {\n                                        '--S3_INPUT_BUCKET': s3_input_bucket,\n                                        '--S3_INPUT_KEY_PREFIX': s3_input_key_prefix,\n                                        '--S3_INPUT_FILENAME': s3_input_fn, \n                                        '--S3_OUTPUT_BUCKET': s3_output_bucket,\n                                        '--S3_OUTPUT_KEY_PREFIX': s3_output_key_prefix,\n                                        '--S3_MODEL_BUCKET': s3_model_bucket,\n                                        '--S3_MODEL_KEY_PREFIX': s3_model_key_prefix\n                                       })\n```", "```py\njob_run_status = glue_client.get_job_run(JobName=job_name,RunId=job_run_id)['JobRun']['JobRunState']\n```", "```py\nabcnews_df = pd.read_csv(os.path.join('s3://', s3_output_bucket, f.key))\n```", "```py\nvol_train = int(0.8 * abcnews_csr.shape[0])\n\ntrain_data = abcnews_csr[:vol_train, :] \ntest_data = abcnews_csr[vol_train:, :]\n\nvol_test = test_data.shape[0]\nval_data = test_data[:vol_test//2, :]\ntest_data = test_data[vol_test//2:, :]\n```", "```py\nntm_estmtr_abc.fit({'train': s3_train, 'validation': s3_val, 'auxiliary': s3_aux})\n```", "```py\nInternational Politics and Conflict\n[0.40, 0.94] defends decision denies war anti pm warns un bush report iraq calls public australia minister backs wins tas plans chief\n\nSports and Crime\n[0.52, 0.77] clash top win world tour test pakistan back record cup killed title final talks england set australia us still pm\n\nNatural Disasters and Funding\n[0.45, 0.90] urged indigenous water power take call lead boost final residents get wa act funds england centre fire help plan funding\n\nProtest and Law Enforcement\n[0.51, 0.72] new record says found strike set win cup south police fire us go pay court plan rise australia bid deal\n\nCrime\n[0.54, 0.93] charged dies murder man charges crash death dead car two woman accident face charge found attack police injured court sydney\n```", "```py\nntm_model = Model(model_data=modeldataurl, image=container)\n```", "```py\nsparkml_data = 's3://{}/{}/{}'.format(s3_model_bucket, s3_model_key_prefix, 'model.tar.gz')\nsparkml_model = SparkMLModel(model_data=sparkml_data, env={'SAGEMAKER_SPARKML_SCHEMA' : schema_json})\n```", "```py\nsm_model = PipelineModel(name=model_name, role=role, models=[sparkml_model, ntm_model])\n```", "```py\nsm_model.deploy(initial_instance_count=1, instance_type='ml.c4.xlarge', endpoint_name=endpoint_name)\n```", "```py\npredictor = RealTimePredictor(endpoint=endpoint_name, sagemaker_session=sess, serializer=json_serializer,\n content_type=CONTENT_TYPE_JSON, accept=CONTENT_TYPE_CSV)\n```", "```py\npredictor.predict(payload)\n```", "```py\npayload = {\n    \"schema\": {\n        \"input\": [\n        {\n            \"name\": \"headline_text\",\n            \"type\": \"string\"\n        }, \n    ],\n    \"output\": \n        {\n            \"name\": \"features\",\n            \"type\": \"double\",\n            \"struct\": \"vector\"\n        }\n    },\n    \"data\": [\n        [\"lisa scaffidi public hearing possible over expenses scandal\"]\n            ]\n\n}\n```", "```py\n{\"predictions\":[{\"topic_weights\":[0.5172129869,0.0405323133,0.2246916145,0.1741439849,0.0434190407]}]}\n```", "```py\ntransformer = sagemaker.transformer.Transformer(\n model_name = model_name,\n instance_count = 1,\n instance_type = 'ml.m4.xlarge',\n strategy = 'SingleRecord',\n assemble_with = 'Line',\n output_path = output_data_path,\n base_transform_job_name='serial-inference-batch',\n sagemaker_session=sess,\n accept = CONTENT_TYPE_CSV\n)\n```", "```py\ntransformer.transform(data = input_data_path,\n                      job_name = job_name,\n                      content_type = CONTENT_TYPE_CSV, \n                      split_type = 'Line')\n```"]